import { SUITE, MODE } from '../../consts.js';
import { getOprfParams } from '../../oprf.js';
import { ModeImpl } from './ModeImpl.js';
import { getCryptoProvider } from '../../cryptoImpl.js';
export class OprfApiImpl {
    constructor(_crypto) {
        this._crypto = _crypto;
        this.Suite = SUITE;
        this.Mode = MODE;
    }
    get crypto() {
        return this._crypto ?? getCryptoProvider();
    }
    withConfig(config) {
        return new OprfApiImpl(config.crypto);
    }
    makeMode(params) {
        const group = this.crypto.Group.get(getOprfParams(params.suite)[1]);
        return new ModeImpl(params.mode, params.suite, group, this.crypto);
    }
}
//# sourceMappingURL=OprfApiImpl.js.map