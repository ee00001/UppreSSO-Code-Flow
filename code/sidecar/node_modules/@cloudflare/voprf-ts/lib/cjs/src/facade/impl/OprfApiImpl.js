"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.OprfApiImpl = void 0;
const consts_js_1 = require("../../consts.js");
const oprf_js_1 = require("../../oprf.js");
const ModeImpl_js_1 = require("./ModeImpl.js");
const cryptoImpl_js_1 = require("../../cryptoImpl.js");
class OprfApiImpl {
    constructor(_crypto) {
        this._crypto = _crypto;
        this.Suite = consts_js_1.SUITE;
        this.Mode = consts_js_1.MODE;
    }
    get crypto() {
        return this._crypto ?? (0, cryptoImpl_js_1.getCryptoProvider)();
    }
    withConfig(config) {
        return new OprfApiImpl(config.crypto);
    }
    makeMode(params) {
        const group = this.crypto.Group.get((0, oprf_js_1.getOprfParams)(params.suite)[1]);
        return new ModeImpl_js_1.ModeImpl(params.mode, params.suite, group, this.crypto);
    }
}
exports.OprfApiImpl = OprfApiImpl;
//# sourceMappingURL=OprfApiImpl.js.map